(this["webpackJsonpcard-memory-game-client"]=this["webpackJsonpcard-memory-game-client"]||[]).push([[0],{108:function(e,n,t){e.exports=t(157)},113:function(e,n,t){},115:function(e,n,t){},120:function(e,n,t){},121:function(e,n,t){},122:function(e,n,t){},124:function(e,n,t){},154:function(e,n){},157:function(e,n,t){"use strict";t.r(n);var r={};t.r(r),t.d(r,"items",(function(){return F})),t.d(r,"toastText",(function(){return _})),t.d(r,"isTryingToFlipCard",(function(){return G})),t.d(r,"setIsTryingToFlipCard",(function(){return P})),t.d(r,"tryFlipCard",(function(){return Y})),t.d(r,"bumpMoves",(function(){return z})),t.d(r,"setCardIsUp",(function(){return D})),t.d(r,"flipCard",(function(){return H})),t.d(r,"onFlipCard",(function(){return J})),t.d(r,"removeCards",(function(){return B})),t.d(r,"showToast",(function(){return K})),t.d(r,"clearToast",(function(){return L})),t.d(r,"onShowToast",(function(){return W})),t.d(r,"coverCards",(function(){return q})),t.d(r,"fetchCards",(function(){return Q})),t.d(r,"setCards",(function(){return V})),t.d(r,"checkIfGameIsOver",(function(){return X})),t.d(r,"resetGame",(function(){return Z})),t.d(r,"playAgain",(function(){return $})),t.d(r,"loading",(function(){return ee})),t.d(r,"onLoading",(function(){return ne})),t.d(r,"isGameOver",(function(){return te})),t.d(r,"isShowToast",(function(){return re})),t.d(r,"moves",(function(){return oe}));var o={};t.r(o),t.d(o,"userName",(function(){return ie})),t.d(o,"roomId",(function(){return se})),t.d(o,"roomName",(function(){return ue})),t.d(o,"availableRooms",(function(){return le})),t.d(o,"socket",(function(){return fe})),t.d(o,"isConnected",(function(){return de})),t.d(o,"isAwaitingOtherPlayer",(function(){return me})),t.d(o,"opponent",(function(){return pe})),t.d(o,"isInsideRoom",(function(){return be})),t.d(o,"isMyTurn",(function(){return ve})),t.d(o,"setIsMyTurn",(function(){return he})),t.d(o,"fetchAvailableRooms",(function(){return ge})),t.d(o,"setIsConnected",(function(){return Oe})),t.d(o,"setAvailableRooms",(function(){return je})),t.d(o,"setSocket",(function(){return ye})),t.d(o,"setRoomId",(function(){return Ee})),t.d(o,"setRoomName",(function(){return Ce})),t.d(o,"setUserName",(function(){return Te})),t.d(o,"setIsAwaitingOtherPlayer",(function(){return we})),t.d(o,"setOpponent",(function(){return Ie})),t.d(o,"notifyFlipCard",(function(){return xe})),t.d(o,"turnEnd",(function(){return ke})),t.d(o,"onTurnEnd",(function(){return Re})),t.d(o,"connect",(function(){return Ne})),t.d(o,"createRoom",(function(){return Ae})),t.d(o,"leaveRoom",(function(){return Me})),t.d(o,"joinRoom",(function(){return Se})),t.d(o,"onIsInsideRoomChange",(function(){return Ue}));var a=t(0),c=t.n(a),i=t(8),s=t.n(i);t(113),t(114),t(115);function u(){return c.a.createElement("footer",null,"Made with ",c.a.createElement("span",{style:{color:"#f00"}},"\u2764")," by Idan Izicovich")}var l=t(6);var f=t(207),d=t(200),m=t(205);var p=c.a.memo((function(){var e=Object(l.h)((function(e){return e.cards})),n=e.isShowToast,t=e.toastText,r=e.isGood;return c.a.createElement(f.a,{open:n,TransitionComponent:d.a,anchorOrigin:{vertical:"top",horizontal:"right"}},c.a.createElement(m.a,{severity:r?"success":"error"},t))})),b=(t(120),t(27));var v=c.a.memo((function(e){var n=e.index,t=(e.id,e.isUp),r=e.url,o=e.isActive,i=e.description,s=Object(l.g)((function(e){return e.cards})).tryFlipCard,u=Object(a.useState)(""),f=Object(b.a)(u,2),d=f[0],m=f[1];return Object(a.useEffect)((function(){var e="";t?(e+="flip-up",o||(e+=" disabled")):e="flip-down",m(e)}),[t,o]),c.a.createElement("div",{onClick:function(){return s(n)},className:"card "+d},t&&c.a.createElement("img",{src:r,alt:i}))}));function h(){var e=function(){var e=Object(l.g)((function(e){return e.cards})).fetchCards,n=Object(l.h)((function(e){return e.cards})).items;return Object(a.useEffect)((function(){e()}),[e]),{items:n}}().items;return c.a.createElement("section",{className:"cards"},c.a.createElement("article",{style:{gridTemplate:"repeat(".concat(Math.ceil(Math.pow(e.length,.5)),", 1fr) / repeat(").concat(Math.ceil(Math.pow(e.length,.5)),", 1fr)"),justifyItems:"center"}},e.map((function(e,n){return c.a.createElement(v,Object.assign({},e,{key:n}))}))),c.a.createElement(p,null))}var g=c.a.memo((function(){var e=Object(l.h)((function(e){return e.cards})).moves;return c.a.createElement("h5",{style:{display:"grid",gap:"1em",gridTemplate:"1fr / 1fr 1fr 1fr",justifyItems:"center"}},c.a.createElement("span",null,"\ud83c\udfc3\ud83c\udffb\u200d\u2642\ufe0f"),c.a.createElement("span",null," Moves:"),c.a.createElement("span",null,e))})),O=(t(121),t(202));function j(){var e=Object(l.g)((function(e){return e.cards})).playAgain;return c.a.createElement("section",{className:"game-over"},c.a.createElement("h3",null,"Game Over"),c.a.createElement("h4",null,"Player ",1," won!"),c.a.createElement("article",null,c.a.createElement(O.a,{color:"primary",variant:"contained",onClick:function(){return e()}},"Play Again?")))}t(122);var y=t(22),E=t.n(y),C=t(35),T=t(204),w=t(94),I=t(99),x=t(96),k=(t(124),t(206));function R(e){return new Promise((function(n){return setTimeout((function(){n()}),e)}))}function N(){var e=Object(l.h)((function(e){return e.session})).userName,n=Object(l.g)((function(e){return e.session})),t=n.setUserName,r=n.connect,o=function(e){e.preventDefault(),r()};return c.a.createElement("article",{className:"user-name-input"},c.a.createElement(T.a,{className:"text-input",label:"User Name",variant:"outlined",value:e,onChange:function(e){e.preventDefault(),t(e.target.value)},onKeyUp:function(e){return 13===e.keyCode&&o(e)}}),c.a.createElement(O.a,{className:"btn submit-button",variant:"contained",color:"primary",onClick:o},"Enter"))}function A(e){var n=e.onClick,t=Object(a.useState)(!1),r=Object(b.a)(t,2),o=r[0],i=r[1],s=Object(a.useRef)(null),u=function(){var e=Object(C.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(),i(!0),e.next=4,R(2e3);case 4:i(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,c.a.createElement(O.a,{className:"btn invite",variant:"contained",color:"primary",ref:s,onClick:u},"Invite"),c.a.createElement(I.a,{target:s.current,show:o,placement:"right"},(function(e){return c.a.createElement(w.a,Object.assign({id:"overlay-example"},e),"Copied!")})))}function M(){var e=window.location.pathname.match(/[^\/]+/g)||[],n=Object(b.a)(e,1)[0],t=Object(l.h)((function(e){return e.session})),r=Object(l.g)((function(e){return e.session})),o=r.joinRoom,i=r.createRoom,s=Object(a.useState)(!1),u=Object(b.a)(s,2),f=u[0],d=u[1];c.a.useEffect((function(){if(!t.isInsideRoom&&!n){var e=Object(k.a)();i(e),console.log({roomName:e})}}),[t.isInsideRoom]),c.a.useEffect((function(){n&&t.isConnected&&!t.isInsideRoom&&(d(!0),o(n))}));return c.a.createElement("article",{className:"invite"},f?c.a.createElement(x.a,{animation:"border"}):c.a.createElement(A,{onClick:function(){var e=window.location.href+t.roomId;navigator.clipboard.writeText(e).then((function(){console.log("copied!",{text:e})})).catch((function(e){console.log(e)}))}}))}function S(){var e=Object(l.h)((function(e){return e.session.isConnected}));return c.a.createElement("main",{className:"login"},c.a.createElement("section",null,c.a.createElement("header",null,c.a.createElement("h1",null,"Card Memory Game")),e?c.a.createElement(M,null):c.a.createElement(N,null)),c.a.createElement(u,null))}var U=t(68),F=(t(97),Math.pow(4,2),t(74),[]),_="",G=!1,P=Object(l.b)((function(e,n){e.isTryingToFlipCard=n})),Y=Object(l.e)((function(e,n,t){var r=t.getStoreState,o=t.getStoreActions;console.log("[tryFlipCard]",{payload:n});var a=r().session;(void 0===a?{}:a).isMyTurn?(e.setIsTryingToFlipCard(!0),e.flipCard(n),e.bumpMoves(),o().session.notifyFlipCard(n)):e.showToast({text:"Wait for your turn."})})),z=Object(l.b)((function(e){console.log("[bumpMoves]"),e.moves++})),D=Object(l.b)((function(e,n){console.log("[setCardIsUp]",{payload:n});var t=n.index,r=n.isUp,o=e.items.find((function(e){return e.index===t}));o?o.isUp=r:console.log("[setCardIsUp] card index ".concat(t," not found."))})),H=Object(l.e)((function(e,n,t){var r=t.getState;if(console.log("[flipCard]",{payload:n}),!(r().items.filter((function(e){return e.isActive&&e.isUp})).length>=2)){var o=n;e.setCardIsUp({index:o,isUp:!0})}})),J=Object(l.f)((function(e){return e.flipCard}),function(){var e=Object(C.a)(E.a.mark((function e(n,t,r){var o,a,c,i,s,u,l,f,d,m,p;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.getState,a=r.getStoreActions,c=r.getStoreState,i=r.meta,s=r.injections,console.log("[onFlipCard]"),u=t.payload,l=o().items.find((function(e){return e.index===u}))){e.next=7;break}return console.log("[onFlipCard] card index ".concat(u," not found.")),e.abrupt("return");case 7:if(f=o().items.find((function(e){return e!==l&&e.id===l.id})),!((d=o().items.filter((function(e){return e.isUp&&e.isActive}))).length>=2)){e.next=24;break}if(!((null===f||void 0===f?void 0:f.isUp)&&l.isUp)){e.next=18;break}return m="".concat(c().session.isMyTurn?"You":"He"," found ").concat(l.description,"!"),n.showToast({text:m,isGood:c().session.isMyTurn}),e.next=15,R(1e3);case 15:n.removeCards([l,f]),e.next=24;break;case 18:return p=c().session.isMyTurn?"You are wrong! Turn passes to opponent...":"He is wrong. Your turn now...",n.showToast({text:p,isGood:!c().session.isMyTurn}),e.next=22,R(1400);case 22:n.coverCards(d),c().session.isMyTurn&&o().isTryingToFlipCard&&(console.log("[onFlipCard]",{meta:i,injections:s}),a().session.turnEnd());case 24:n.setIsTryingToFlipCard(!1);case 25:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}()),B=Object(l.b)((function(e,n){n.forEach((function(e){return e.isActive=!1}))})),K=Object(l.b)((function(e,n){e.isShowToast=!0,e.toastText=n.text,e.isGood=n.isGood})),L=Object(l.b)((function(e){e.isShowToast=!1})),W=Object(l.f)((function(e){return e.showToast}),function(){var e=Object(C.a)(E.a.mark((function e(n){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(2e3);case 2:n.clearToast();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),q=Object(l.b)((function(e,n){n.forEach((function(e){return e.isUp=!1}))})),Q=Object(l.e)(function(){var e=Object(C.a)(E.a.mark((function e(n,t,r){var o,a,c,i,s,u,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.getStoreState,a="/api/cards",c=o(),i=c.session,(s=void 0===i?{}:i).isInsideRoom?a+="?roomId=".concat(s.roomId):console.log("[fetch cards] user is fetching cards outside of room"),e.next=6,fetch(a);case 6:if(!(u=e.sent).ok){e.next=14;break}return e.next=10,u.json();case 10:l=e.sent,n.setCards(l),e.next=15;break;case 14:console.log("response is not ok "+"status: ".concat(u.status," ").concat(u.text));case 15:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}()),V=Object(l.b)((function(e,n){e.items=n})),X=Object(l.c)((function(e){return e.removeCards}),(function(e){0===e.items.filter((function(e){return e.isActive})).length&&(e.isGameOver=!0)})),Z=Object(l.b)((function(e){e.isGameOver=!1,e.items=[],e.moves=0})),$=Object(l.e)((function(e){e.resetGame(),e.fetchCards()})),ee=!1,ne=Object(l.c)((function(e){return[e.fetchCards.startType,e.fetchCards.type]}),(function(e,n){var t=Object(b.a)(n.resolvedTargets,2),r=t[0],o=t[1];switch(n.type){case r:e.loading=!0;break;case o:e.loading=!1}})),te=!1,re=!1,oe=0,ae=t(98),ce=t.n(ae),ie="",se="",ue="",le=[],fe=null,de=!1,me=!1,pe={id:"",userName:""},be=!1,ve=!1,he=Object(l.b)((function(e,n){e.isMyTurn=n})),ge=Object(l.e)(function(){var e=Object(C.a)(E.a.mark((function e(n){var t,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[fetchAvailableRooms] in"),e.prev=1,e.next=4,fetch("/api/rooms");case 4:if(!(t=e.sent).ok){e.next=12;break}return e.next=8,t.json();case 8:r=e.sent,n.setAvailableRooms(r.available),e.next=13;break;case 12:console.log("[fetchAvailableRooms]",{response:t});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),console.log("[fetchAvailableRooms]",{error:e.t0});case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(n){return e.apply(this,arguments)}}()),Oe=Object(l.b)((function(e,n){e.isConnected=n})),je=Object(l.b)((function(e,n){e.availableRooms=n})),ye=Object(l.b)((function(e,n){e.socket=n})),Ee=Object(l.b)((function(e,n){e.roomId=n})),Ce=Object(l.b)((function(e,n){e.roomName=n})),Te=Object(l.b)((function(e,n){e.userName=n})),we=Object(l.b)((function(e,n){e.isAwaitingOtherPlayer=n})),Ie=Object(l.b)((function(e,n){e.opponent=n})),xe=Object(l.b)((function(e,n){var t=e.socket,r=e.roomId,o=n;t&&r&&t.emit("flip_card",r,o)})),ke=Object(l.b)((function(e){console.log("turnEnd"),e.isMyTurn=!1})),Re=Object(l.c)((function(e){return e.turnEnd}),(function(e){console.log("notifyTurnEnd");var n=e.socket,t=e.roomId;n&&t&&n.emit("turn_end",t)})),Ne=Object(l.e)((function(e,n,t){var r=t.getStoreActions,o=ce()(),a=function(n){n<2?e.setIsAwaitingOtherPlayer(!0):e.setIsAwaitingOtherPlayer(!1)};o.on("connect",(function(){e.setIsConnected(o.connected)})),o.on("message",(function(e){console.log(e)})),o.on("roomId",(function(n,t){e.setRoomId(n),a(t)})),o.on("other_player_join",(function(n,t,r){e.setOpponent({id:n,userName:t}),a(r)})),o.on("other_player_flip_card",(function(e,n){console.log("[other_player_flip_card]",{otherPlayerUserName:e,cardIndex:n}),r().cards.flipCard(n)})),o.on("error",(function(e){console.log(e)})),o.on("turn_change",(function(n){console.log("[turn_change]",{isMyTurn:n}),e.setIsMyTurn(n)})),e.setSocket(o)})),Ae=Object(l.b)((function(e,n){var t=n,r=e.userName;e.socket&&e.socket.emit("create_room",t,r)})),Me=Object(l.b)((function(e){var n=e.roomId,t=e.socket;t&&n&&t.emit("leave_room",n)})),Se=Object(l.b)((function(e,n){var t=n,r=e.socket,o=e.userName;r&&r.emit("join_room",t,o)})),Ue=Object(l.c)((function(e){return[e.leaveRoom,e.setRoomId]}),(function(e,n){var t=Object(b.a)(n.resolvedTargets,2),r=t[0],o=t[1];switch(n.type){case o:e.isInsideRoom=!0;break;case r:e.isInsideRoom=!1}})),Fe={cards:Object(U.a)({},r),session:Object(U.a)({},o)},_e=Object(l.d)(Fe);s.a.render(c.a.createElement(l.a,{store:_e},c.a.createElement((function(){var e=Object(l.h)((function(e){return e.cards})).isGameOver,n=Object(l.h)((function(e){return e.session}));return n.isConnected&&n.isInsideRoom&&!n.isAwaitingOtherPlayer?c.a.createElement("main",null,c.a.createElement("header",null,c.a.createElement(g,null)),e?c.a.createElement(j,null):c.a.createElement(h,null),c.a.createElement(u,null)):c.a.createElement(S,null)}),null)),document.getElementById("root"))}},[[108,1,2]]]);
//# sourceMappingURL=main.d0e5da3e.chunk.js.map